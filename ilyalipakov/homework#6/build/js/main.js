"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,e)})(e)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _construct(e,t,r){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(o,r.prototype),o}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Card=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).timerId=null,e}return _inherits(t,_wrapNativeSuper(HTMLElement)),_createClass(t,[{key:"connectedCallback",value:function(){var e=this,t=this.getAttribute("title"),r=this.getAttribute("desc"),n=this.getAttribute("date"),o=this.getAttribute("time"),a=parseInt(this.getAttribute("index")),i=this.getAllCardsFromStorage()||[];a||(a=i.length+1),this.innerHTML='\n      <div class="card">\n        <div class="card__title">'.concat(t,'</div>\n        <div class="card__desc">').concat(r,'</div>\n        <div class="card__deadline">\n          Осталось: \n          <span class="card__day"></span> Дня\n          <span class="card__hours"></span> часов\n          <span class="card__minutes"></span> минут\n          <span class="card__seconds"></span> секунд\n        </div>\n        <div class="card__delete" onclick="this.parentNode.parentNode.remove()" >\n          Удалить\n        </div>\n      </div>\n    '),this.setAttribute("index",a),this.addDataToStorage({index:a,title:t,desc:r,date:n,time:o}),this.renderDeadline(n,o),this.timerId=setInterval(function(){e.renderDeadline(n,o)},1e3)}},{key:"disconnectedCallback",value:function(){var e=parseInt(this.getAttribute("index"));this.deleteDataFromStorage(e),clearInterval(this.timerId)}},{key:"calculateDeadline",value:function(e,t){var r=Date.parse("".concat(e," ").concat(t))-Date.now(),n=Math.floor(r/1e3%60),o=Math.floor((r-n)/6e4%60),a=Math.floor((r-o)/36e5%24);return{days:Math.floor((r-a)/864e5),hours:a,minutes:o,seconds:n}}},{key:"renderDeadline",value:function(e,t){var r=this.querySelector(".card__day"),n=this.querySelector(".card__hours"),o=this.querySelector(".card__minutes"),a=this.querySelector(".card__seconds"),i=this.calculateDeadline(e,t),s=i.days,c=i.hours,u=i.minutes,l=i.seconds;this.updateBackground(s),r.innerHTML=s,n.innerHTML=c,o.innerHTML=u,a.innerHTML=l}},{key:"updateBackground",value:function(e){var t=this.querySelector(".card");0==e?t.classList.add("warning"):e<0&&t.classList.add("danger")}},{key:"addDataToStorage",value:function(e){var t=this.getAllCardsFromStorage();this.checkIsCard(t,e)||localStorage.setItem("cards",JSON.stringify([].concat(_toConsumableArray(t),[e])))}},{key:"deleteDataFromStorage",value:function(e){var t=this.getAllCardsFromStorage(),r=t.findIndex(function(t){return t.index===e});localStorage.setItem("cards",JSON.stringify([].concat(_toConsumableArray(t.slice(0,r)),_toConsumableArray(t.slice(r+1)))))}},{key:"getAllCardsFromStorage",value:function(){return JSON.parse(localStorage.getItem("cards"))||[]}},{key:"checkIsCard",value:function(e,t){for(var r=0;r<e.length;r++)if(this.deepEqual(e[r],t))return!0;return!1}},{key:"deepEqual",value:function(e,t){return JSON.stringify({index:e.index,title:e.title,desc:e.desc,date:e.date,time:e.time})===JSON.stringify({index:t.index,title:t.title,desc:t.desc,date:t.date,time:t.time})}}]),t}(),Popup=function(){function e(t){var r=t.popup,n=t.overlay;_classCallCheck(this,e),this.popup=r,this.overlay=n}return _createClass(e,[{key:"show",value:function(){this._togglePopup(!0)}},{key:"hide",value:function(){this._togglePopup(!1)}},{key:"_togglePopup",value:function(e){e?(this.popup.classList.add("show"),this.overlay.classList.add("show"),this.popup.classList.remove("hide"),this.overlay.classList.remove("hide")):(this.popup.classList.add("hide"),this.overlay.classList.add("hide"),this.popup.classList.remove("show"),this.overlay.classList.remove("show"))}}]),e}();customElements.define("new-card",Card);var addBtn=document.querySelector(".add"),overlay=document.querySelector(".overlay"),popup=document.querySelector(".popup"),closeBtn=document.querySelector(".popup__close"),cards=document.querySelector(".deadlines"),titleInput=document.querySelector(".popup__title"),descInput=document.querySelector(".popup__desc"),dateInput=document.querySelector(".popup__date"),timeInput=document.querySelector(".popup__time"),addTask=document.querySelector(".popup__btn"),taskPopup=new Popup({popup:popup,overlay:overlay});function isEmptyField(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.some(function(e){return""===e.value})}function createCardWith(e){var t=document.createElement("new-card");t.setAttribute("title",e.title),t.setAttribute("desc",e.desc),t.setAttribute("date",e.date),t.setAttribute("time",e.time),e.index&&t.setAttribute("index",e.index),cards.appendChild(t)}addBtn.addEventListener("click",function(){taskPopup.show()}),closeBtn.addEventListener("click",function(){taskPopup.hide()}),addTask.addEventListener("click",function(){isEmptyField(titleInput,descInput,dateInput,timeInput)||(createCardWith({title:titleInput.value,desc:descInput.value,date:dateInput.value,time:timeInput.value}),taskPopup.hide())});var allcards=JSON.parse(localStorage.getItem("cards"))||[];allcards.forEach(function(e){createCardWith({index:e.index,title:e.title,desc:e.desc,date:e.date,time:e.time})});
//# sourceMappingURL=main.js.map
